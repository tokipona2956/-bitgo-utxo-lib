// {signature} {pubKey}
var bscript = require('../../script');
var typeforce = require('typeforce');
function check(script) {
    var chunks = bscript.decompile(script);
    return chunks.length === 2 &&
        bscript.isCanonicalSignature(chunks[0]) &&
        bscript.isCanonicalPubKey(chunks[1]);
}
check.toJSON = function () { return 'pubKeyHash input'; };
function encodeStack(signature, pubKey) {
    typeforce({
        signature: bscript.isCanonicalSignature,
        pubKey: bscript.isCanonicalPubKey
    }, {
        signature: signature,
        pubKey: pubKey
    });
    return [signature, pubKey];
}
function encode(signature, pubKey) {
    return bscript.compile(encodeStack(signature, pubKey));
}
function decodeStack(stack) {
    typeforce(check, stack);
    return {
        signature: stack[0],
        pubKey: stack[1]
    };
}
function decode(buffer) {
    var stack = bscript.decompile(buffer);
    return decodeStack(stack);
}
module.exports = {
    check: check,
    decode: decode,
    decodeStack: decodeStack,
    encode: encode,
    encodeStack: encodeStack
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvdGVtcGxhdGVzL3B1YmtleWhhc2gvaW5wdXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsdUJBQXVCO0FBRXZCLElBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQTtBQUNyQyxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUE7QUFFcEMsU0FBUyxLQUFLLENBQUUsTUFBTTtJQUNwQixJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBRXRDLE9BQU8sTUFBTSxDQUFDLE1BQU0sS0FBSyxDQUFDO1FBQ3hCLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3hDLENBQUM7QUFDRCxLQUFLLENBQUMsTUFBTSxHQUFHLGNBQWMsT0FBTyxrQkFBa0IsQ0FBQSxDQUFDLENBQUMsQ0FBQTtBQUV4RCxTQUFTLFdBQVcsQ0FBRSxTQUFTLEVBQUUsTUFBTTtJQUNyQyxTQUFTLENBQUM7UUFDUixTQUFTLEVBQUUsT0FBTyxDQUFDLG9CQUFvQjtRQUN2QyxNQUFNLEVBQUUsT0FBTyxDQUFDLGlCQUFpQjtLQUNsQyxFQUFFO1FBQ0QsU0FBUyxFQUFFLFNBQVM7UUFDcEIsTUFBTSxFQUFFLE1BQU07S0FDZixDQUFDLENBQUE7SUFFRixPQUFPLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFBO0FBQzVCLENBQUM7QUFFRCxTQUFTLE1BQU0sQ0FBRSxTQUFTLEVBQUUsTUFBTTtJQUNoQyxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFBO0FBQ3hELENBQUM7QUFFRCxTQUFTLFdBQVcsQ0FBRSxLQUFLO0lBQ3pCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUE7SUFFdkIsT0FBTztRQUNMLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ25CLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO0tBQ2pCLENBQUE7QUFDSCxDQUFDO0FBRUQsU0FBUyxNQUFNLENBQUUsTUFBTTtJQUNyQixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQ3JDLE9BQU8sV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQzNCLENBQUM7QUFFRCxNQUFNLENBQUMsT0FBTyxHQUFHO0lBQ2YsS0FBSyxFQUFFLEtBQUs7SUFDWixNQUFNLEVBQUUsTUFBTTtJQUNkLFdBQVcsRUFBRSxXQUFXO0lBQ3hCLE1BQU0sRUFBRSxNQUFNO0lBQ2QsV0FBVyxFQUFFLFdBQVc7Q0FDekIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIHtzaWduYXR1cmV9IHtwdWJLZXl9XG5cbnZhciBic2NyaXB0ID0gcmVxdWlyZSgnLi4vLi4vc2NyaXB0JylcbnZhciB0eXBlZm9yY2UgPSByZXF1aXJlKCd0eXBlZm9yY2UnKVxuXG5mdW5jdGlvbiBjaGVjayAoc2NyaXB0KSB7XG4gIHZhciBjaHVua3MgPSBic2NyaXB0LmRlY29tcGlsZShzY3JpcHQpXG5cbiAgcmV0dXJuIGNodW5rcy5sZW5ndGggPT09IDIgJiZcbiAgICBic2NyaXB0LmlzQ2Fub25pY2FsU2lnbmF0dXJlKGNodW5rc1swXSkgJiZcbiAgICBic2NyaXB0LmlzQ2Fub25pY2FsUHViS2V5KGNodW5rc1sxXSlcbn1cbmNoZWNrLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICdwdWJLZXlIYXNoIGlucHV0JyB9XG5cbmZ1bmN0aW9uIGVuY29kZVN0YWNrIChzaWduYXR1cmUsIHB1YktleSkge1xuICB0eXBlZm9yY2Uoe1xuICAgIHNpZ25hdHVyZTogYnNjcmlwdC5pc0Nhbm9uaWNhbFNpZ25hdHVyZSxcbiAgICBwdWJLZXk6IGJzY3JpcHQuaXNDYW5vbmljYWxQdWJLZXlcbiAgfSwge1xuICAgIHNpZ25hdHVyZTogc2lnbmF0dXJlLFxuICAgIHB1YktleTogcHViS2V5XG4gIH0pXG5cbiAgcmV0dXJuIFtzaWduYXR1cmUsIHB1YktleV1cbn1cblxuZnVuY3Rpb24gZW5jb2RlIChzaWduYXR1cmUsIHB1YktleSkge1xuICByZXR1cm4gYnNjcmlwdC5jb21waWxlKGVuY29kZVN0YWNrKHNpZ25hdHVyZSwgcHViS2V5KSlcbn1cblxuZnVuY3Rpb24gZGVjb2RlU3RhY2sgKHN0YWNrKSB7XG4gIHR5cGVmb3JjZShjaGVjaywgc3RhY2spXG5cbiAgcmV0dXJuIHtcbiAgICBzaWduYXR1cmU6IHN0YWNrWzBdLFxuICAgIHB1YktleTogc3RhY2tbMV1cbiAgfVxufVxuXG5mdW5jdGlvbiBkZWNvZGUgKGJ1ZmZlcikge1xuICB2YXIgc3RhY2sgPSBic2NyaXB0LmRlY29tcGlsZShidWZmZXIpXG4gIHJldHVybiBkZWNvZGVTdGFjayhzdGFjaylcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNoZWNrOiBjaGVjayxcbiAgZGVjb2RlOiBkZWNvZGUsXG4gIGRlY29kZVN0YWNrOiBkZWNvZGVTdGFjayxcbiAgZW5jb2RlOiBlbmNvZGUsXG4gIGVuY29kZVN0YWNrOiBlbmNvZGVTdGFja1xufVxuIl19